第一正規化（1NF：消除重複群組、確保欄位原子性）
目標：確保每個欄位都是「單一值」，而非多值或array。

處理過程：
原表中有「先修課程」欄位，有時一門課可能有多個先修課，例如：

課程名稱	先修課程
網頁設計	程式設計, 資料結構

這樣就違反 1NF（多值欄位）。

我們將每一個先修課關係獨立成多筆紀錄：

課程名稱	先修課程
網頁設計	程式設計
網頁設計	資料結構

同時確保表中每個欄位都不可再分割。

✅ 1NF 後結果：
學號	姓名	系所名稱	課程名稱	學分	學期	類型	先修課程	成績	修課狀態
A114514810	李田索	資通系	程式設計	3	一上	必修	無	90	已修
A114514810	李田索	資通系	資料結構	3	二上	必修	程式設計	-	修習中
A114514810	李田索	資通系	資料庫系統	3	二下	必修	資料結構	-	未修

➡️ ✅ 現在每個欄位都只存一個值，符合 1NF。

第二正規化（2NF：消除部分依賴）
目標：所有非主鍵欄位必須「完全依賴主鍵」。
在複合主鍵中（例如 學號 + 課程名稱），不能有欄位只依賴其中一個部分。

分析：

在上表中，「姓名」「系所名稱」只依賴學號，不依賴課程名稱。
→ 部分依賴「學號」
同樣，「學分」「類型」「先修課程」只依賴課程名稱，不依賴學生。

所以，我們要把表格拆成兩個主題：

(A) 學生基本資料表（students）
學號	姓名	系所名稱
A114514810	李田索	資通系
(B) 修課紀錄表（enrollments）
學號	課程名稱	成績	修課狀態
A114514810	程式設計	90	已修
A114514810	資料結構	-	修習中
A114514810	資料庫系統	-	未修
(C) 課程基本資料表（courses）
課程名稱	學分	學期	類型	先修課程
程式設計	3	一上	必修	無
資料結構	3	二上	必修	程式設計
資料庫系統	3	二下	必修	資料結構

✅ 每個非主鍵欄位都完全依賴該表的主鍵。

🧩 3️⃣ 第三正規化（3NF：消除傳遞依賴）
✅ 目標：

非主鍵欄位不能依賴其他非主鍵欄位。

🧮 分析：

在學生表中：

「系所名稱」是非主鍵欄位，但它會決定「學院名稱」
→ 傳遞依賴（學生 → 系所 → 學院）
在課程表中：

「先修課程」其實指向另一門課 → 應改為關聯表

🔧 處理：

拆出新的獨立表格。

(A) 系所資料表（departments）
系所代碼	系所名稱	學院名稱
510	資通系	資訊學院

學生表改為：

學號	姓名	系所代碼
A114514810	李田索	510
(B) 課程先修關係表（course_prerequisite）
課程代碼	先修課程代碼
2	1
3	2

課程表改為：

課程代碼	課程名稱	學分	學期	類型	系所代碼
1	程式設計	3	一上	必修	510
2	資料結構	3	二上	必修	510
3	資料庫系統	3	二下	必修	510

✅ 現在所有非主鍵欄位都只依賴主鍵，不再有傳遞依賴。
👉 資料庫達到 第三正規化 (3NF)。

📘 四、最終正規化結構圖（3NF 完成）
departments(系所)
   ↑
   │
students(學生)── enrollments(修課紀錄) ──> courses(課程) ──> course_prerequisite(先修關聯)

📄 五、各階段比較總結
階段	狀態	問題	解決方式
UNF	混雜、重複資料	一筆資料含多主題	分拆表格
1NF	原子性完成	重複資訊、部分依賴	拆學生 / 課程 / 修課
2NF	消除部分依賴	傳遞依賴仍存在	拆出系所與先修課表
3NF	無重複、無異常	結構清晰	完成最終設計
✅ 六、最終正規化成果（可直接實作）
表名	功能	關聯
departments	系所資料	與 students、courses 關聯
students	學生資料	dept_id 外鍵
courses	課程資料	dept_id 外鍵
course_prerequisite	課程先修	course_id 自關聯
enrollments	修課紀錄	關聯 students 與 courses
✨ 七、正規化成果優點
類型	優點
🔄 更新	修改課程或系所名稱，只需改一筆資料
🚫 刪除	不會誤刪其他關聯資料（外鍵保護）
🧾 新增	可自由擴充課程、學生，不重複
📊 查詢	可透過 JOIN 快速組合學程地圖資料
☁️ 雲端	結構輕量，適合 Neon / PostgreSQL


-- 驗證用
-- SELECT * FROM users;

-- (謹慎執行) 刪除舊表
-- DROP TABLE admins CASCADE;
-- DROP TABLE students CASCADE;